cmake_minimum_required(VERSION 3.0)

project(sqlite3)

set(SA sqlite-amalgamation)

add_library(sqlite3
    ${SA}/sqlite3.c
)

target_include_directories(sqlite3
    PUBLIC ${SA}
)

if(MSVC)
    target_compile_definitions(sqlite3
        PRIVATE SQLITE_API=__declspec\(dllexport\)
    )
else()
endif()

include(GNUInstallDirs)

set (PHDR 
    ${SA}/sqlite3.h
    ${SA}/sqlite3ext.h
)

install(TARGETS sqlite3
    PUBLIC_HEADER DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/sqlite3
    RUNTIME DESTINATION bin
    LIBRARY DESTINATION lib
    ARCHIVE DESTINATION lib
)

install(FILES ${PHDR} DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/sqlite3)
